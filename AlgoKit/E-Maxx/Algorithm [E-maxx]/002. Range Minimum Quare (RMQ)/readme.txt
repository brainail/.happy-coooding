Time preprocessing: O(N)
Time: O(1) ~~~~~~~O(log(N))
Memory: O(N)